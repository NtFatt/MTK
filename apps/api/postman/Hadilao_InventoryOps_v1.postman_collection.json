{
  "info": {
    "_postman_id": "c0a39f9e-8f5d-4a9c-9a06-2d7e26b46385",
    "name": "Hadilao Inventory Ops v1 (M2)",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Admin Login (token)",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/v1/admin/login",
          "host": ["{{baseUrl}}"],
          "path": ["api", "v1", "admin", "login"]
        },
        "body": {
          "mode": "raw",
          "raw": "{\n  \"username\": \"{{adminUsername}}\",\n  \"password\": \"{{adminPassword}}\"\n}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "const json = pm.response.json();",
              "if (json && json.token) {",
              "  pm.environment.set('adminToken', json.token);",
              "}"
            ]
          }
        }
      ]
    },
    {
      "name": "Get Branch Stock (MySQL)",
      "request": {
        "method": "GET",
        "header": [
          { "key": "Authorization", "value": "Bearer {{adminToken}}" }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/v1/admin/inventory/stock?branchId={{smokeBranchId}}",
          "host": ["{{baseUrl}}"],
          "path": ["api", "v1", "admin", "inventory", "stock"],
          "query": [
            { "key": "branchId", "value": "{{smokeBranchId}}" }
          ]
        }
      }
    },
    {
      "name": "Adjust Stock (RESTOCK/DEDUCT/SET)",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{adminToken}}" }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/v1/admin/inventory/stock/adjust",
          "host": ["{{baseUrl}}"],
          "path": ["api", "v1", "admin", "inventory", "stock", "adjust"]
        },
        "body": {
          "mode": "raw",
          "raw": "{\n  \"branchId\": \"{{smokeBranchId}}\",\n  \"itemId\": \"{{menuItemId}}\",\n  \"mode\": \"RESTOCK\",\n  \"quantity\": 10\n}"
        }
      }
    },
    {
      "name": "List Active Holds (Redis)",
      "request": {
        "method": "GET",
        "header": [
          { "key": "Authorization", "value": "Bearer {{adminToken}}" }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/v1/admin/inventory/holds?branchId={{smokeBranchId}}&limit=200",
          "host": ["{{baseUrl}}"],
          "path": ["api", "v1", "admin", "inventory", "holds"],
          "query": [
            { "key": "branchId", "value": "{{smokeBranchId}}" },
            { "key": "limit", "value": "200" }
          ]
        }
      }
    },
    {
      "name": "Get Drift Metrics (Redis)",
      "request": {
        "method": "GET",
        "header": [
          { "key": "Authorization", "value": "Bearer {{adminToken}}" }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/v1/admin/inventory/rehydrate/metrics",
          "host": ["{{baseUrl}}"],
          "path": ["api", "v1", "admin", "inventory", "rehydrate", "metrics"]
        }
      }
    },
    {
      "name": "Run Rehydrate (Redis) - requires STOCK_REHYDRATE_ENABLED=true",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Authorization", "value": "Bearer {{adminToken}}" }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/v1/admin/inventory/rehydrate/run",
          "host": ["{{baseUrl}}"],
          "path": ["api", "v1", "admin", "inventory", "rehydrate", "run"]
        }
      }
    },
    {
      "name": "Bump Menu Version (Redis) - requires MENU_CACHE_ENABLED=true",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Authorization", "value": "Bearer {{adminToken}}" }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/v1/admin/inventory/menu/bump",
          "host": ["{{baseUrl}}"],
          "path": ["api", "v1", "admin", "inventory", "menu", "bump"]
        }
      }
    }
  ]
}
